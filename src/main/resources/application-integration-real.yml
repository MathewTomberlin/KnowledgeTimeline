spring:
  datasource:
    url: ${spring.datasource.url:jdbc:postgresql://localhost:5432/knowledge_middleware_test}
    username: ${spring.datasource.username:postgres}
    password: ${spring.datasource.password:postgres}
    driver-class-name: org.postgresql.Driver
    hikari:
      connection-timeout: 20000
      maximum-pool-size: 5

  flyway:
    enabled: false  # Disable Flyway for integration tests

  jpa:
    hibernate:
      ddl-auto: create-drop  # Let Hibernate create the schema

  test:
    webtestclient:
      timeout: 30s  # Longer timeout for real LLM calls

  autoconfigure:
    exclude:
      # Exclude security for testing
      - org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration
      - org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration

# Real service integration test settings
knowledge:
  embeddings:
    url: http://localhost:8081/embeddings
    model: sentence-transformers/all-MiniLM-L6-v2

  llm:
    base-url: http://localhost:11434
    model: llama2

  blob-storage:
    type: local
    local:
      path: ./data/test-blobs

  vector-store:
    type: postgres

logging:
  level:
    middleware: DEBUG
    org.springframework.web: DEBUG
    org.springframework.test: INFO
